Question 1

Without payload and header information, Netflow provides a summary rather than specifics but still contains useful information for detecting attacks like source and destination IP, port, and other details about the connection rather than what is in it. For scanning, spamming, and DDoS attacks, the number of connections, how long the sessions last, and how the connections are being made (port, flags) can be used to identify the patterns that indicate these threats, which can be compared to packet data at the router in order to detect and confirm these attacks. In long term infiltration like data exfiltration there are suspicious patterns such as large transfers to unknown IP addresses that are detectable even if we can't see the payloads directly. But further analysis would be required to confirm the malicious activity. So overall the lack of payload information doesn't prevent attack detection for major types of malicious traffic. 

---
Question 2

Processing large amounts of raw packet data is time and compute intensive which can be a limiting factor in detecting attacks. A large packet capture can be megabytes to gigabytes compared to flows which can be bytes for the same time range, because it contains only metadata which can be a significant drawback compared to the detail that packet capture retains. However flows have scope and scale advantages to be able to store information about the whole network for long periods of time to analyze patterns and trends. Quickly processing this information can help make faster security decisions and gain broader insights. However the payloads in each packet are lost which may make some traffic ambiguous. For example you might see a large amount of data being sent over many sessions, but not what data is being sent and without the ability to determine if it is legitimate or malicious. Still, flows retain many crucial factors to the sessions and connections that can be used effectively for security like establishing context if not the content.

---
Question 3 

By using flows we can determine when and where attacks might be happening and then look directly at logs for errors, events, and behaviors to confirm our suspicions of malicious activity such as failed login attempts. This approach retains the benefits of using summaries that flows provide efficiently while having access to the specifics as needed. Using flows over a long period of time with profiling could help establish a baseline for activity that is seen as normal, where anomalous values and patterns could raise suspicions and point to where security events may need to be examined in more detail with logs and further investigation.

---
Question 4

This threshold based approach with fixed parameters could be effective by carefully defining typical traffic for the network, as well as with ongoing tuning to avoid false positives and negatives as the network and its activity can change over time as well as the types of attacks the network is subjected to. It is not uncommon in IPS to use detection thresholds, and these unexpectedness values could work to raise red flags on anomalies but this approach would still require ongoing supervision to detect evolving or novel attacks. For example there could be attacks that resemble legitimate traffic that don't meet the unexpectedness threshold.

---
Question 5

Netflow data is small and fast to work with using tools to filter and analyze flow data. However some open source tools such as rwfilter and rwcut in SILK tools can be cumbersome and requires use of the CLI or scripting compared to more business friendly tools that can be quicker to set up and start using, and provide easier interaction and visualization of the data. Netflow's drawbacks such as the lack of payload and content can be supplemented with other tools to offset the lack of depth. However this would require manual integration when using open source tools as well as setting up data pipelines, understanding the tools, and achieving effectiveness with them on the particular network by iterating which takes time. From my experience, many businesses would rather pay for fast start up and established processes that mostly work now than to pursue it themselves and spend on the ramp up even if open source can be more flexible and "free".

Sources

Module 2 Lectures

Choudhary, S & Srinivasan, B. (2013). Usage of NetFlow in security and monitoring of computer networks.

Gates, C & Collins, M. (2004). More Netflow Tools: For Performance and Security.